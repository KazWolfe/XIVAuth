<% content_for(:page_header) do %>
  <div class="d-flex justify-content-between align-items-center">
    <h1>Create New Application</h1>
  </div>
  <p>Register a new application that can use XIVAuth's services.</p>
<% end %>

<div class="card mb-4">
  <%= form_for @application, url: app_submit_path(@application), as: :client_application, html: { role: 'form' } do |f| %>
    <% if @application.errors.any? %>
      <div class="alert alert-danger m-3"><p><%= t('doorkeeper.applications.form.error') %></p></div>
    <% end %>

    <div class="card-body">
      <div class="row">
        <div class="col-md-6">
          <div class="mb-3">
            <%= f.label :name, "App Name", class: "form-label fw-semibold" %>
            <%= f.text_field :name, class: "form-control #{ 'is-invalid' if @application.errors[:name].present? }", placeholder: "My Awesome App", required: true %>
            <%= doorkeeper_errors_for @application, :name %>
            <div class="form-text">The name of your app as it appears to users.</div>
          </div>

          <div class="mb-3">
            <div class="form-check form-switch">
              <%= f.check_box :private, class: "form-check-input", role: "switch" %>
              <%= f.label :private, "Private App", class: "form-check-label fw-semibold" %>
            </div>
            <%= doorkeeper_errors_for @application, :private %>
            <div class="form-text">Private apps can only be used by the owners and permitted users.</div>
          </div>
        </div>

        <div class="col-md-6">
          <%= f.fields_for :profile, @application.profile do |pf| %>
            <div class="mb-3">
              <%= pf.label :homepage_url, "Homepage URL", class: "form-label fw-semibold" %>
              <%= pf.url_field :homepage_url, class: "form-control" %>
              <div class="form-text">The main website for your app.</div>
            </div>

            <div class="mb-3">
              <%= pf.label :privacy_policy_url, "Privacy Policy URL", class: "form-label fw-semibold" %>
              <%= pf.url_field :privacy_policy_url, class: "form-control" %>
              <div class="form-text">Link to your app's privacy policy.</div>
            </div>

            <div class="mb-3">
              <%= pf.label :terms_of_service_url, "Terms of Service URL", class: "form-label fw-semibold" %>
              <%= pf.url_field :terms_of_service_url, class: "form-control" %>
              <div class="form-text">Link to your app's terms of service.</div>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <div class="card-footer bg-transparent d-flex justify-content-end gap-2">
      <%= f.submit t('doorkeeper.applications.buttons.submit'), class: 'btn btn-primary' %>
      <%= link_to t('doorkeeper.applications.buttons.cancel'), developer_applications_path, class: 'btn btn-secondary' %>
    </div>
  <% end %>
</div>
